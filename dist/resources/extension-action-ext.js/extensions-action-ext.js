(function(){"use strict";var __webpack_modules__={"./src/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ActionExtension: function() { return /* binding */ ActionExtension; },\n/* harmony export */   ActionFlyout: function() { return /* binding */ ActionFlyout; },\n/* harmony export */   StatusExtension: function() { return /* binding */ StatusExtension; },\n/* harmony export */   flyout: function() { return /* binding */ flyout; },\n/* harmony export */   statusComponent: function() { return /* binding */ statusComponent; },\n/* harmony export */   toolbarComponent: function() { return /* binding */ toolbarComponent; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "moment");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);\nvar _a, _b;\n\n\nconst TITLE = "Change Request";\nconst ID = "Change_Request";\nconst ActionExtension = ({ application, openFlyout }) => {\n  var _a2;\n  return ((_a2 = application.metadata) == null ? void 0 : _a2.labels) && application.metadata.labels["application.environmentLabelKey"] === "prd" ? /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null, /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement("button", { onClick: openFlyout, style: { marginRight: "2px" }, className: "argo-button argo-button--base" }, /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement("span", { style: { marginLeft: "-5px", marginRight: "5px" }, className: "show-for-large" }, " Request Elevation"))) : /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null);\n};\nconst StatusExtension = ({ application, openFlyout }) => {\n  const data = JSON.parse(localStorage.getItem(application.metadata.name));\n  const [refresh, setRefresh] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    var _a2;\n    if (!data)\n      return;\n    const expiryTime = moment__WEBPACK_IMPORTED_MODULE_1__(data.expiryTime);\n    const diffInSeconds = expiryTime.diff(moment__WEBPACK_IMPORTED_MODULE_1__(), "seconds");\n    if (diffInSeconds <= 0) {\n      console.log("Time has expired");\n      localStorage.removeItem((_a2 = application.metadata) == null ? void 0 : _a2.name);\n      return;\n    }\n    const timeoutId = setTimeout(() => {\n      var _a3;\n      console.log("Time has expired");\n      localStorage.removeItem((_a3 = application.metadata) == null ? void 0 : _a3.name);\n      setRefresh(false);\n    }, diffInSeconds * 1e3);\n    return () => clearTimeout(timeoutId);\n  }, [data]);\n  return data && data.expiryTime ? /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", { key: data == null ? void 0 : data.name }, "Devops user can perform the prod changes until ", data.currentTime) : /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null);\n};\nconst ActionFlyout = ({ application }) => {\n  const currentTime = moment__WEBPACK_IMPORTED_MODULE_1__().format("MMMM Do YYYY, h:mm:ss a");\n  const expiryTime = moment__WEBPACK_IMPORTED_MODULE_1__().add(1, "minute");\n  const mockData = { expiryTime, currentTime, subtitle: "Elevation Granted", userMsg: "Application changes can perform until ...." };\n  const [data, setData] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n  const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    let isMounted = true;\n    fetch("https://www.google.com").then((response) => response.text()).then(() => {\n      if (isMounted && loading) {\n        setData(mockData);\n        localStorage.setItem(application.metadata.name, JSON.stringify(mockData));\n        setLoading(false);\n      }\n    }).catch((error) => {\n      console.error("Error fetching data:", error);\n      if (isMounted) {\n        const storedData = localStorage.getItem(application.metadata.name);\n        if (!storedData) {\n          localStorage.setItem(application.metadata.name, JSON.stringify(mockData));\n          setData(mockData);\n        } else {\n          setData(JSON.parse(storedData));\n        }\n        setLoading(false);\n      }\n    });\n    return () => {\n      isMounted = false;\n    };\n  }, [loading]);\n  if (loading) {\n    return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div", null, "Loading...");\n  }\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null);\n};\nconst toolbarComponent = ActionExtension;\nconst statusComponent = StatusExtension;\nconst flyout = ActionFlyout;\n(_a = window == null ? void 0 : window.extensionsAPI) == null ? void 0 : _a.registerToolBarExtension(toolbarComponent, TITLE, ID, flyout);\n(_b = window == null ? void 0 : window.extensionsAPI) == null ? void 0 : _b.registerStatusPanelExtension(statusComponent, TITLE, ID);\n\n\n//# sourceURL=webpack://tmp.extensions/./src/index.tsx?')},moment:function(e){e.exports=window.Moment},react:function(e){e.exports=window.React}},__webpack_module_cache__={};function __webpack_require__(e){var _=__webpack_module_cache__[e];if(void 0!==_)return _.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=function(e){var _=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(_,{a:_}),_},__webpack_require__.d=function(e,_){for(var t in _)__webpack_require__.o(_,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:_[t]})},__webpack_require__.o=function(e,_){return Object.prototype.hasOwnProperty.call(e,_)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/index.tsx");(window.tmp=window.tmp||{}).extensions=__webpack_exports__})();